{"ast":null,"code":"import RoleEdit from \"./components/RoleEdit\";\nimport { reactive, toRefs, computed, ref, onMounted, getCurrentInstance } from \"vue\";\nimport { useRoute, useRouter } from \"vue-router\";\nimport { useStore } from \"vuex\";\nimport { findName } from \"../common\"; //*导入公共查询方法\n\nimport { onSubmit, resetForm, handleSizeChange, handleCurrentChange } from \"@/views/layoutpages/common\";\nconst __default__ = {\n  data: () => ({\n    description: \"角色信息查询与设置\",\n    menus: {\n      search: {\n        name: \"查询\"\n      },\n      add: {\n        name: \"添加\"\n      },\n      edit: {\n        name: \"编辑\"\n      },\n      del: {\n        name: \"删除\"\n      },\n      member: {\n        name: \"查看成员\",\n        toPath: true\n      } //topath:true 需要设置跳转路径\n\n    }\n  })\n};\nexport default /*#__PURE__*/Object.assign(__default__, {\n  __name: 'Roles',\n\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const {\n      proxy\n    } = getCurrentInstance();\n    const route = useRoute();\n    const router = useRouter();\n    const store = useStore();\n    const menuList = computed(() => store.getters.menuList).value;\n    const rowData = ref(null);\n    const dialogTitle = ref(\"\");\n    const showDialog = ref(false);\n    const queryForm = ref(null);\n    const tableData = ref([]);\n    const params = reactive({\n      name: \"\",\n      limit: 10,\n      page: 1,\n      total: 0\n    });\n    const {\n      name,\n      limit,\n      page,\n      total\n    } = toRefs(params);\n    /**\r\n     * @description:添加or编辑事件\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    const handleEdit = (title, row = null) => {\n      showDialog.value = true;\n      dialogTitle.value = title;\n      rowData.value = row;\n    };\n    /**\r\n     * @description: dialog事件\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n\n    const handelDialog = e => {\n      showDialog.value = e;\n      getDataList();\n    };\n    /**删除行数据\r\n     * @description:\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n\n    const handleDel = id => {\n      proxy.$confirm(\"此操作将永久删除该数据, 是否继续?\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\",\n        type: \"error\"\n      }).then(async () => {\n        const {\n          code\n        } = await VE_API.system.roleDel({\n          id\n        });\n\n        if (code == \"00\") {\n          getDataList();\n        }\n      }).catch(() => {\n        proxy.$message({\n          type: \"info\",\n          message: \"已取消删除\"\n        });\n      });\n    };\n    /**\r\n     * @description:查看成员\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n\n    const allMember = id => {\n      // 获取当前path的id\n      let pathId = route.name.slice(route.name.lastIndexOf(\"-\") + 1); // 获取要跳转到的路由\n\n      const toName = findName(\"member\", \"system/Users\", pathId, menuList, proxy);\n      router.push({\n        name: toName,\n        query: {\n          id\n        }\n      });\n    };\n    /**\r\n     * @description: 获取列表数据\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n\n    const getDataList = async () => {\n      const {\n        code,\n        data\n      } = await VE_API.system.roleList(params);\n\n      if (code == \"00\") {\n        const {\n          limit,\n          page,\n          total,\n          list\n        } = data;\n        params.limit = limit;\n        params.page = page;\n        params.total = total;\n        tableData.value = list;\n      }\n    };\n\n    onMounted(async () => {\n      await getDataList(); // maxHeight(pagination, queryForm, toolBar, ve_max_height);\n    });\n    const __returned__ = {\n      proxy,\n      route,\n      router,\n      store,\n      menuList,\n      rowData,\n      dialogTitle,\n      showDialog,\n      queryForm,\n      tableData,\n      params,\n      name,\n      limit,\n      page,\n      total,\n      handleEdit,\n      handelDialog,\n      handleDel,\n      allMember,\n      getDataList,\n      RoleEdit,\n      reactive,\n      toRefs,\n      computed,\n      ref,\n      onMounted,\n      getCurrentInstance,\n      useRoute,\n      useRouter,\n      useStore,\n      findName,\n      onSubmit,\n      resetForm,\n      handleSizeChange,\n      handleCurrentChange\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n});","map":{"version":3,"mappings":"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","names":["RoleEdit","reactive","toRefs","computed","ref","onMounted","getCurrentInstance","useRoute","useRouter","useStore","findName","onSubmit","resetForm","handleSizeChange","handleCurrentChange","data","description","menus","search","name","add","edit","del","member","toPath","proxy","route","router","store","menuList","getters","value","rowData","dialogTitle","showDialog","queryForm","tableData","params","limit","page","total","handleEdit","title","row","handelDialog","e","getDataList","handleDel","id","$confirm","confirmButtonText","cancelButtonText","type","then","code","VE_API","system","roleDel","catch","$message","message","allMember","pathId","slice","lastIndexOf","toName","push","query","roleList","list"],"sources":["C:/Users/Administrator/Desktop/vue3-element-admin-dev/src/views/layoutpages/system/Roles.vue"],"sourcesContent":["<!--\r\n * @Author: your name\r\n * @Date: 2021-02-05 14:52:13\r\n * @LastEditTime: 2021-11-30 18:49:18\r\n * @LastEditors: Please set LastEditors\r\n * @Description: In User Settings Edit\r\n * @FilePath: \\vue3-element-admin\\src\\views\\layoutpages\\system\\Roles.vue\r\n-->\r\n<template>\r\n    <div class=\"ve_container\">\r\n        <!-- 搜索 -->\r\n        <el-form ref=\"queryForm\" :inline=\"true\" :model=\"params\">\r\n            <el-form-item label=\"名称\" prop=\"name\">\r\n                <el-input\r\n                    clearable\r\n                    v-model=\"name\"\r\n                    placeholder=\"请输入\"\r\n                ></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button\r\n                    type=\"primary\"\r\n                    @click=\"onSubmit(params, getDataList)\"\r\n                >\r\n                    {{ menus.search.name }}\r\n                </el-button>\r\n                <el-button @click=\"resetForm(queryForm, params, getDataList)\">\r\n                    重置\r\n                </el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n\r\n        <!-- 列表 -->\r\n        <ve-table\r\n            :table=\"{\r\n                data: tableData,\r\n            }\"\r\n            :pagination=\"{\r\n                onSizeChange: (val) =>\r\n                    handleSizeChange(val, params, getDataList),\r\n                onCurrentChange: (val) =>\r\n                    handleCurrentChange(val, params, getDataList),\r\n                currentPage: page,\r\n                pageSize: limit,\r\n                total: total,\r\n            }\"\r\n        >\r\n            <template #tool_bar>\r\n                <el-button\r\n                    v-permission=\"['add']\"\r\n                    size=\"small\"\r\n                    type=\"primary\"\r\n                    @click=\"handleEdit(menus.add.name)\"\r\n                >\r\n                    {{ menus.add.name }}\r\n                </el-button>\r\n            </template>\r\n            <el-table-column prop=\"name\" label=\"名称\"></el-table-column>\r\n            <el-table-column\r\n                prop=\"roleName\"\r\n                label=\"角色名\"\r\n                width=\"120\"\r\n            ></el-table-column>\r\n            <el-table-column prop=\"status\" label=\"状态\">\r\n                <template v-slot=\"{ row }\">\r\n                    <el-tag :type=\"row.status == 0 ? 'danger' : ''\">\r\n                        {{ row.status == 0 ? \"停用\" : \"启用\" }}\r\n                    </el-tag>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column fixed=\"right\" label=\"操作\">\r\n                <template v-slot:default=\"{ row }\">\r\n                    <el-button\r\n                        v-permission=\"['edit']\"\r\n                        @click.prevent=\"handleEdit(menus.edit.name, row)\"\r\n                        type=\"primary\"\r\n                        size=\"small\"\r\n                    >\r\n                        {{ menus.edit.name }}\r\n                    </el-button>\r\n                    <el-button\r\n                        v-permission=\"['del']\"\r\n                        @click.prevent=\"handleDel(row.id)\"\r\n                        type=\"danger\"\r\n                        size=\"small\"\r\n                    >\r\n                        {{ menus.del.name }}\r\n                    </el-button>\r\n                    <el-button\r\n                        v-permission=\"['member']\"\r\n                        @click.prevent=\"allMember(row.id)\"\r\n                        type=\"info\"\r\n                        size=\"small\"\r\n                    >\r\n                        {{ menus.member.name }}\r\n                    </el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </ve-table>\r\n\r\n        <!-- 编辑组件 -->\r\n        <role-edit\r\n            v-if=\"showDialog\"\r\n            :rowData=\"rowData\"\r\n            :title=\"dialogTitle\"\r\n            :showDialog=\"showDialog\"\r\n            @closeDialog=\"handelDialog($event)\"\r\n        />\r\n    </div>\r\n</template>\r\n<script>\r\nexport default {\r\n    data: () => ({\r\n        description: \"角色信息查询与设置\",\r\n        menus: {\r\n            search: { name: \"查询\" },\r\n            add: { name: \"添加\" },\r\n            edit: { name: \"编辑\" },\r\n            del: { name: \"删除\" },\r\n            member: { name: \"查看成员\", toPath: true }, //topath:true 需要设置跳转路径\r\n        },\r\n    }),\r\n};\r\n</script>\r\n\r\n<script setup>\r\nimport RoleEdit from \"./components/RoleEdit\";\r\nimport {\r\n    reactive,\r\n    toRefs,\r\n    computed,\r\n    ref,\r\n    onMounted,\r\n    getCurrentInstance,\r\n} from \"vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { useStore } from \"vuex\";\r\nimport { findName } from \"../common\";\r\n\r\n//*导入公共查询方法\r\nimport {\r\n    onSubmit,\r\n    resetForm,\r\n    handleSizeChange,\r\n    handleCurrentChange,\r\n} from \"@/views/layoutpages/common\";\r\n\r\nconst { proxy } = getCurrentInstance();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst store = useStore();\r\nconst menuList = computed(() => store.getters.menuList).value;\r\n\r\nconst rowData = ref(null);\r\nconst dialogTitle = ref(\"\");\r\nconst showDialog = ref(false);\r\n\r\nconst queryForm = ref(null);\r\nconst tableData = ref([]);\r\nconst params = reactive({\r\n    name: \"\",\r\n    limit: 10,\r\n    page: 1,\r\n    total: 0,\r\n});\r\nconst { name, limit, page, total } = toRefs(params);\r\n\r\n/**\r\n * @description:添加or编辑事件\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst handleEdit = (title, row = null) => {\r\n    showDialog.value = true;\r\n    dialogTitle.value = title;\r\n    rowData.value = row;\r\n};\r\n/**\r\n * @description: dialog事件\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst handelDialog = (e) => {\r\n    showDialog.value = e;\r\n    getDataList();\r\n};\r\n/**删除行数据\r\n * @description:\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst handleDel = (id) => {\r\n    proxy\r\n        .$confirm(\"此操作将永久删除该数据, 是否继续?\", \"提示\", {\r\n            confirmButtonText: \"确定\",\r\n            cancelButtonText: \"取消\",\r\n            type: \"error\",\r\n        })\r\n        .then(async () => {\r\n            const { code } = await VE_API.system.roleDel({ id });\r\n            if (code == \"00\") {\r\n                getDataList();\r\n            }\r\n        })\r\n        .catch(() => {\r\n            proxy.$message({\r\n                type: \"info\",\r\n                message: \"已取消删除\",\r\n            });\r\n        });\r\n};\r\n/**\r\n * @description:查看成员\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst allMember = (id) => {\r\n    // 获取当前path的id\r\n    let pathId = route.name.slice(route.name.lastIndexOf(\"-\") + 1);\r\n    // 获取要跳转到的路由\r\n    const toName = findName(\"member\", \"system/Users\", pathId, menuList, proxy);\r\n    router.push({ name: toName, query: { id } });\r\n};\r\n/**\r\n * @description: 获取列表数据\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst getDataList = async () => {\r\n    const { code, data } = await VE_API.system.roleList(params);\r\n    if (code == \"00\") {\r\n        const { limit, page, total, list } = data;\r\n        params.limit = limit;\r\n        params.page = page;\r\n        params.total = total;\r\n        tableData.value = list;\r\n    }\r\n};\r\nonMounted(async () => {\r\n    await getDataList();\r\n    // maxHeight(pagination, queryForm, toolBar, ve_max_height);\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}