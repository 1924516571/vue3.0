{"ast":null,"code":"import { resolveDirective as _resolveDirective, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"height\": \"400px\",\n    \"margin-top\": \"20px\"\n  },\n  ref: \"liveChart\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _directive_resize = _resolveDirective(\"resize\");\n\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", _hoisted_1, null, 512\n  /* NEED_PATCH */\n  )), [[_directive_resize, $setup.myChart]]);\n}","map":{"version":3,"mappings":";;EAWQA,KAAuC,EAAvC;IAAA;IAAA;EAAA;EACAC,GAAG,EAAC;;;;;wCAHRC,oBAIO,KAJP,cAIO,IAJP,EAIO;EAAA;EAJP,IAIO,qBAHOC,eAGP","names":["style","ref","_createElementBlock","$setup"],"sourceRoot":"","sources":["C:\\Users\\Administrator\\Desktop\\vue3-element-admin-dev\\src\\components\\dashboard\\LiveChart.vue"],"sourcesContent":["<!--\r\n * @Author: your name\r\n * @Date: 2021-03-16 15:09:41\r\n * @LastEditTime: 2022-01-20 14:19:13\r\n * @LastEditors: Please set LastEditors\r\n * @Description: In User Settings Edit\r\n * @FilePath: \\vue3-element-admin\\src\\components\\dashboard\\LiveChart.vue\r\n-->\r\n<template>\r\n    <div\r\n        v-resize=\"myChart\"\r\n        style=\"height: 400px; margin-top: 20px\"\r\n        ref=\"liveChart\"\r\n    ></div>\r\n</template>\r\n\r\n<script setup>\r\nimport * as echarts from \"echarts/core\";\r\nimport {\r\n    TitleComponent,\r\n    TooltipComponent,\r\n    GridComponent,\r\n} from \"echarts/components\";\r\nimport { BarChart } from \"echarts/charts\";\r\nimport { CanvasRenderer } from \"echarts/renderers\";\r\nimport * as dayjs from \"dayjs\";\r\nimport { unwarp } from \"@/utils\";\r\nimport { onMounted, ref, onUnmounted } from \"vue\";\r\n\r\n/**\r\n * @description: 生成20条数据\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst dataList = () => {\r\n    let date = [];\r\n    let num = [];\r\n    let nowTime = new Date().getTime();\r\n    for (let i = 0; i < 30; i++) {\r\n        date.push(dayjs(nowTime - i * 1000).format(\"HH:mm:ss\"));\r\n        num.push((Math.random() * 10).toFixed(0) * 1);\r\n    }\r\n    return {\r\n        date: date.reverse(),\r\n        num,\r\n    };\r\n};\r\n\r\necharts.use([\r\n    TitleComponent,\r\n    TooltipComponent,\r\n    GridComponent,\r\n    BarChart,\r\n    CanvasRenderer,\r\n]);\r\nconst liveChart = ref(null);\r\nconst myChart = ref(null);\r\nlet timer = null;\r\n\r\nlet $_dataList = dataList();\r\nlet option = {\r\n    title: {\r\n        text: \"用户访问量\",\r\n    },\r\n    grid: {\r\n        left: \"0\",\r\n        right: \"0\",\r\n        top: \"10%\",\r\n        bottom: \"0\",\r\n        containLabel: true,\r\n    },\r\n    tooltip: {\r\n        trigger: \"axis\",\r\n    },\r\n    xAxis: {\r\n        data: $_dataList.date,\r\n    },\r\n    yAxis: {\r\n        type: \"value\",\r\n    },\r\n    series: [\r\n        {\r\n            data: $_dataList.num,\r\n            type: \"bar\",\r\n            showBackground: true,\r\n            backgroundStyle: {\r\n                color: \"rgba(180, 180, 180, 0.2)\",\r\n            },\r\n        },\r\n    ],\r\n};\r\n/**\r\n * @description: 动态数据\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst getNewData = (myChart) => {\r\n    unwarp(myChart.value).setOption(option);\r\n\r\n    timer = setInterval(() => {\r\n        $_dataList.date.shift();\r\n        $_dataList.num.shift();\r\n        $_dataList.date.push(dayjs(new Date().getTime()).format(\"HH:mm:ss\"));\r\n        $_dataList.num.push((Math.random() * 10).toFixed(0) * 1);\r\n        unwarp(myChart.value).setOption(option);\r\n    }, 1000);\r\n};\r\nonMounted(() => {\r\n    myChart.value = echarts.init(liveChart.value);\r\n    getNewData(myChart);\r\n});\r\nonUnmounted(() => {\r\n    unwarp(myChart.value).dispose();\r\n    clearInterval(timer);\r\n    timer = null;\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}