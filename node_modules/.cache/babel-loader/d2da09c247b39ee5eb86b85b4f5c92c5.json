{"ast":null,"code":"import { reactive, toRefs, ref } from \"vue\";\nexport default {\n  __name: 'UsersEdit',\n  props: {\n    showDialog: {\n      type: Boolean,\n      default: true\n    },\n    title: {\n      type: String,\n      default: \"添加\"\n    },\n    rowData: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: [\"closeDialog\"],\n\n  setup(__props, {\n    expose,\n    emit\n  }) {\n    expose();\n    const props = __props;\n    const rules = {\n      name: [{\n        required: true,\n        message: \"请输入用户名\",\n        trigger: \"blur\"\n      }],\n      userName: [{\n        required: true,\n        message: \"请输入账户\",\n        trigger: \"blur\"\n      }],\n      password: [{\n        required: true,\n        message: \"请输入密码\",\n        trigger: \"blur\"\n      }],\n      role: [{\n        required: true,\n        message: \"请选择角色\",\n        trigger: \"change\"\n      }]\n    };\n    const {\n      title,\n      rowData\n    } = toRefs(props);\n\n    const closeDialog = () => {\n      emit(\"closeDialog\", false);\n    };\n\n    const formRef = ref(null);\n    const form = reactive({\n      name: \"\",\n      userName: \"\",\n      password: \"\",\n      role: \"\",\n      status: 1\n    });\n    const {\n      userName,\n      name,\n      password,\n      role,\n      status\n    } = toRefs(form);\n    const roleList = ref([]);\n    /**\r\n     * @description: 初始化\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    rowData.value && (name.value = rowData.value.name, userName.value = rowData.value.userName, password.value = rowData.value.password, role.value = rowData.value.role, status.value = rowData.value.status);\n    /**\r\n     * @description: 获取角色列表\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    const getRoleList = async () => {\n      const {\n        code,\n        data\n      } = await VE_API.system.roleList({\n        page: 1,\n        limit: 10\n      }, {\n        Global: false\n      });\n\n      if (code == \"00\") {\n        const {\n          list\n        } = data;\n        roleList.value = list;\n      }\n    };\n\n    getRoleList();\n    /**\r\n     * @description:提交\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    const onSubmit = () => {\n      formRef.value.validate(async valid => {\n        if (valid) {\n          let res;\n\n          if (title.value == \"添加\") {\n            res = await VE_API.system.userAdd(form);\n          } else {\n            res = await VE_API.system.userEdit({\n              id: rowData.value.id,\n              ...form\n            });\n          }\n\n          const {\n            code\n          } = res;\n\n          if (code == \"00\") {\n            closeDialog();\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    };\n\n    const __returned__ = {\n      rules,\n      props,\n      emit,\n      title,\n      rowData,\n      closeDialog,\n      formRef,\n      form,\n      userName,\n      name,\n      password,\n      role,\n      status,\n      roleList,\n      getRoleList,\n      onSubmit,\n      reactive,\n      toRefs,\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["reactive","toRefs","ref","rules","name","required","message","trigger","userName","password","role","title","rowData","props","closeDialog","emit","formRef","form","status","roleList","value","getRoleList","code","data","VE_API","system","page","limit","Global","list","onSubmit","validate","valid","res","userAdd","userEdit","id","console","log"],"sources":["C:/Users/Administrator/Desktop/vue3-element-admin-dev/src/views/layoutpages/system/components/UsersEdit.vue"],"sourcesContent":["<!--\r\n * @Author: your name\r\n * @Date: 2021-02-09 15:24:23\r\n * @LastEditTime: 2022-04-28 16:32:16\r\n * @LastEditors: Please set LastEditors\r\n * @Description: In User Settings Edit\r\n * @FilePath: \\vue3-element-admin\\src\\views\\layoutpages\\system\\components\\usersEdit.vue\r\n-->\r\n<template>\r\n    <el-dialog :title=\"title\" append-to-body destroy-on-close :model-value=\"showDialog\" @close=\"closeDialog()\">\r\n        <!-- <span>{{ rowData }}</span> -->\r\n        <!-- 表单 -->\r\n        <el-form :model=\"form\" ref=\"formRef\" :rules=\"rules\" label-width=\"80px\" :inline=\"false\">\r\n            <el-form-item label=\"账号\" prop=\"name\">\r\n                <el-input v-model=\"name\" placeholder=\"\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"用户名\" prop=\"userName\">\r\n                <el-input v-model=\"userName\" placeholder=\"\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"password\">\r\n                <el-input v-model=\"password\" show-password placeholder=\"\" clearable></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"角色\" prop=\"role\">\r\n                <el-select style=\"width: 100%\" v-model=\"role\" placeholder=\"\" clearable>\r\n                    <el-option v-for=\"item in roleList\" :key=\"item.id\" :label=\"item.name\" :value=\"item.id\" :disabled=\"item.status == 0\"></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            <el-form-item label=\"状态\">\r\n                <el-radio-group v-model=\"status\">\r\n                    <el-radio-button :label=\"1\">启用</el-radio-button>\r\n                    <el-radio-button :label=\"0\">停用</el-radio-button>\r\n                </el-radio-group>\r\n            </el-form-item>\r\n        </el-form>\r\n\r\n        <template v-slot:footer>\r\n            <span>\r\n                <el-button @click=\"closeDialog()\">取消</el-button>\r\n                <el-button type=\"primary\" @click=\"onSubmit()\">确定</el-button>\r\n            </span>\r\n        </template>\r\n    </el-dialog>\r\n</template>\r\n\r\n<script setup>\r\nimport { reactive, toRefs, ref } from \"vue\";\r\nconst rules = {\r\n    name: [\r\n        {\r\n            required: true,\r\n            message: \"请输入用户名\",\r\n            trigger: \"blur\",\r\n        },\r\n    ],\r\n    userName: [\r\n        {\r\n            required: true,\r\n            message: \"请输入账户\",\r\n            trigger: \"blur\",\r\n        },\r\n    ],\r\n    password: [\r\n        {\r\n            required: true,\r\n            message: \"请输入密码\",\r\n            trigger: \"blur\",\r\n        },\r\n    ],\r\n    role: [\r\n        {\r\n            required: true,\r\n            message: \"请选择角色\",\r\n            trigger: \"change\",\r\n        },\r\n    ],\r\n};\r\nconst props = defineProps({\r\n    showDialog: {\r\n        type: Boolean,\r\n        default: true,\r\n    },\r\n    title: {\r\n        type: String,\r\n        default: \"添加\",\r\n    },\r\n    rowData: {\r\n        type: Object,\r\n        default: null,\r\n    },\r\n});\r\nconst emit = defineEmits([\"closeDialog\"]);\r\nconst { title, rowData } = toRefs(props);\r\nconst closeDialog = () => {\r\n    emit(\"closeDialog\", false);\r\n};\r\nconst formRef = ref(null);\r\nconst form = reactive({\r\n    name: \"\",\r\n    userName: \"\",\r\n    password: \"\",\r\n    role: \"\",\r\n    status: 1,\r\n});\r\nconst { userName, name, password, role, status } = toRefs(form);\r\nconst roleList = ref([]);\r\n\r\n/**\r\n * @description: 初始化\r\n * @param {*}\r\n * @return {*}\r\n */\r\nrowData.value &&\r\n    ((name.value = rowData.value.name), (userName.value = rowData.value.userName), (password.value = rowData.value.password), (role.value = rowData.value.role), (status.value = rowData.value.status));\r\n/**\r\n * @description: 获取角色列表\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst getRoleList = async () => {\r\n    const { code, data } = await VE_API.system.roleList(\r\n        {\r\n            page: 1,\r\n            limit: 10,\r\n        },\r\n        { Global: false }\r\n    );\r\n    if (code == \"00\") {\r\n        const { list } = data;\r\n        roleList.value = list;\r\n    }\r\n};\r\ngetRoleList();\r\n/**\r\n * @description:提交\r\n * @param {*}\r\n * @return {*}\r\n */\r\nconst onSubmit = () => {\r\n    formRef.value.validate(async (valid) => {\r\n        if (valid) {\r\n            let res;\r\n            if (title.value == \"添加\") {\r\n                res = await VE_API.system.userAdd(form);\r\n            } else {\r\n                res = await VE_API.system.userEdit({\r\n                    id: rowData.value.id,\r\n                    ...form,\r\n                });\r\n            }\r\n            const { code } = res;\r\n            if (code == \"00\") {\r\n                closeDialog();\r\n            }\r\n        } else {\r\n            console.log(\"error submit!!\");\r\n            return false;\r\n        }\r\n    });\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n"]},"metadata":{},"sourceType":"module"}