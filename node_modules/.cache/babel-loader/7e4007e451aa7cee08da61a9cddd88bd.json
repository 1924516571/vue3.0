{"ast":null,"code":"import { unref as _unref, resolveComponent as _resolveComponent, isRef as _isRef, createVNode as _createVNode, withCtx as _withCtx, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createBlock as _createBlock, createTextVNode as _createTextVNode } from \"vue\";\n\nconst _hoisted_1 = /*#__PURE__*/_createTextVNode(\"启用\");\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\"停用\");\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\"确定\");\n\nimport { reactive, toRefs, ref } from \"vue\";\nexport default {\n  __name: 'UsersEditRoute',\n  props: {\n    showDialog: {\n      type: Boolean,\n      default: true\n    },\n    title: {\n      type: String,\n      default: \"添加\"\n    },\n    rowData: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: [\"closeDialog\"],\n\n  setup(__props, {\n    emit\n  }) {\n    const props = __props;\n    const rules = {\n      name: [{\n        required: true,\n        message: \"请输入用户名\",\n        trigger: \"blur\"\n      }],\n      userName: [{\n        required: true,\n        message: \"请输入账户\",\n        trigger: \"blur\"\n      }],\n      password: [{\n        required: true,\n        message: \"请输入密码\",\n        trigger: \"blur\"\n      }],\n      role: [{\n        required: true,\n        message: \"请选择角色\",\n        trigger: \"change\"\n      }]\n    };\n    const {\n      title,\n      rowData\n    } = toRefs(props);\n\n    const closeDialog = () => {\n      emit(\"closeDialog\", false);\n    };\n\n    const formRef = ref(null);\n    const form = reactive({\n      name: \"\",\n      userName: \"\",\n      password: \"\",\n      role: \"\",\n      status: 1\n    });\n    const {\n      userName,\n      name,\n      password,\n      role,\n      status\n    } = toRefs(form);\n    const roleList = ref([]);\n    /**\r\n     * @description: 初始化\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    rowData.value && (name.value = rowData.value.name, userName.value = rowData.value.userName, password.value = rowData.value.password, role.value = rowData.value.role, status.value = rowData.value.status);\n    /**\r\n     * @description: 获取角色列表\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    const getRoleList = async () => {\n      const {\n        code,\n        data\n      } = await VE_API.system.roleList({\n        page: 1,\n        limit: 10\n      }, {\n        Global: false\n      });\n\n      if (code == \"00\") {\n        const {\n          list\n        } = data;\n        roleList.value = list;\n      }\n    };\n\n    getRoleList();\n    /**\r\n     * @description:提交\r\n     * @param {*}\r\n     * @return {*}\r\n     */\n\n    const onSubmit = () => {\n      formRef.value.validate(async valid => {\n        if (valid) {\n          let res;\n\n          if (title.value == \"添加\") {\n            res = await VE_API.system.userAdd(form);\n          } else {\n            res = await VE_API.system.userEdit({\n              id: rowData.value.id,\n              ...form\n            });\n          }\n\n          const {\n            code\n          } = res;\n\n          if (code == \"00\") {\n            closeDialog();\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    };\n\n    return (_ctx, _cache) => {\n      const _component_el_input = _resolveComponent(\"el-input\");\n\n      const _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n      const _component_el_option = _resolveComponent(\"el-option\");\n\n      const _component_el_select = _resolveComponent(\"el-select\");\n\n      const _component_el_radio_button = _resolveComponent(\"el-radio-button\");\n\n      const _component_el_radio_group = _resolveComponent(\"el-radio-group\");\n\n      const _component_el_button = _resolveComponent(\"el-button\");\n\n      const _component_el_form = _resolveComponent(\"el-form\");\n\n      return _openBlock(), _createBlock(_component_el_form, {\n        model: form,\n        ref_key: \"formRef\",\n        ref: formRef,\n        rules: rules,\n        \"label-width\": \"80px\",\n        inline: false\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_form_item, {\n          label: \"账号\",\n          prop: \"name\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            modelValue: _unref(name),\n            \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _isRef(name) ? name.value = $event : null),\n            placeholder: \"\",\n            clearable: \"\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          label: \"用户名\",\n          prop: \"userName\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            modelValue: _unref(userName),\n            \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _isRef(userName) ? userName.value = $event : null),\n            placeholder: \"\",\n            clearable: \"\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          label: \"密码\",\n          prop: \"password\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_input, {\n            modelValue: _unref(password),\n            \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _isRef(password) ? password.value = $event : null),\n            \"show-password\": \"\",\n            placeholder: \"\",\n            clearable: \"\"\n          }, null, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          label: \"角色\",\n          prop: \"role\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_select, {\n            style: {\n              \"width\": \"100%\"\n            },\n            modelValue: _unref(role),\n            \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => _isRef(role) ? role.value = $event : null),\n            placeholder: \"\",\n            clearable: \"\"\n          }, {\n            default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(roleList.value, item => {\n              return _openBlock(), _createBlock(_component_el_option, {\n                key: item.id,\n                label: item.name,\n                value: item.id,\n                disabled: item.status == 0\n              }, null, 8, [\"label\", \"value\", \"disabled\"]);\n            }), 128))]),\n            _: 1\n          }, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, {\n          label: \"状态\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_el_radio_group, {\n            modelValue: _unref(status),\n            \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _isRef(status) ? status.value = $event : null)\n          }, {\n            default: _withCtx(() => [_createVNode(_component_el_radio_button, {\n              label: 1\n            }, {\n              default: _withCtx(() => [_hoisted_1]),\n              _: 1\n            }), _createVNode(_component_el_radio_button, {\n              label: 0\n            }, {\n              default: _withCtx(() => [_hoisted_2]),\n              _: 1\n            })]),\n            _: 1\n          }, 8, [\"modelValue\"])]),\n          _: 1\n        }), _createVNode(_component_el_form_item, null, {\n          default: _withCtx(() => [_createVNode(_component_el_button, {\n            onClick: _cache[5] || (_cache[5] = $event => closeDialog())\n          }, {\n            default: _withCtx(() => [_hoisted_3]),\n            _: 1\n          }), _createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: _cache[6] || (_cache[6] = $event => onSubmit())\n          }, {\n            default: _withCtx(() => [_hoisted_4]),\n            _: 1\n          })]),\n          _: 1\n        })]),\n        _: 1\n      }, 8, [\"model\"]);\n    };\n  }\n\n};","map":null,"metadata":{},"sourceType":"module"}